<div class="container-fluid">
  <div class="row  align-items-baseline mt-2">
    <div class="col-1 d-flex justify-content-between align-items-center">
      <button mat-icon-button color="primary" (click)="changeMonth(-1)" [disabled]="isLoading"><</button>
      {{selectedDate|date:'MM.yyyy'}}
      <button mat-icon-button  color="primary" (click)="changeMonth(1)" [disabled]="isLoading"> > </button>
    </div>
    <div class=" col-2">
      <mat-form-field class="w-100">
        <mat-label>Участок</mat-label>
        <mat-select [(ngModel)]="filterPost" multiple [disabled]="isLoading">

          <mat-option *ngFor="let p of this.Posts" [value]="p">{{p}}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div class=" col-2">
      <mat-form-field class="w-100" >
        <mat-label>ФИО</mat-label>
        <input type="text"  [disabled]="isLoading" [(ngModel)]="filterName" (ngModelChange)="buildData()" matInput>
      </mat-form-field>
    </div>
    <div class="col-1">
      <button mat-raised-button color="primary" [disabled]="isLoading" (click)="saveData()">Сохранить</button>
    </div>
  </div>
  <div class="row">
    <table (contextmenu)="mouseClick($event,null,null)">
      <tr class="order-stat-table-header">
        <th>
          #
        </th>
        <th *ngFor="let d of days; let i = index" style="width: 2%" class="text-center" [ngClass]="{'weekend':d.isWeekend}" >
          <div>{{d.num}}</div>
          <div>{{d.name}}</div>
        </th>
        <th class="text-center">Коэф.</th>
        <th class="text-center">Сумма</th>
      </tr>
      <ng-container *ngFor="let p of this.filterPost">
        <tr class="order-stat-table-row" style="background: rgba(187,98,248,0.25)">
          <td [colSpan]="2+dayCount">
            {{p}}
          </td>
          <td>
            {{sumPostData[p]?.minutes}}
          </td>
        </tr>
        <ng-container *ngFor="let w of workerData[p]">
          <tr *ngFor="let r of this.targetData[p][w]" class="order-stat-table-row">
            <td>{{w}} : {{r}}</td>
            <td class="text-center prevent-select" (click)="mouseClick($event,this.calendarData[p][w][r][d.num].data,this.calendarData[p][w][r][d.num].meta)" (contextmenu)="mouseClick($event,this.calendarData[p][w][r][d.num].data,this.calendarData[p][w][r][d.num].meta)" (mousemove)="mouse($event,this.calendarData[p][w][r][d.num].data,this.calendarData[p][w][r][d.num].meta)" *ngFor="let d of days; let i = index" [ngClass]="{'weekend':d.isWeekend,'selected':this.calendarData[p][w][r][d.num].meta.selected}" >
              <div>{{this.calendarData[p][w][r][d.num].data.planningHours}}</div>
            </td>
            <td class="text-center">
              <mat-form-field style="height: 70px;width: 90px" class="mt-3">
                <input [disabled]="isLoading" type = "number" max="2" min="0" step="0.25" [(ngModel)]="this.calendarData[p][w][r][1].data.planToWorkConst" (ngModelChange)="setEfficiency($event,p,w,r)" matInput>
              </mat-form-field>
            </td>
            <td>
              {{this.sumWorkerData[p][w][r].minutes}}
            </td>
          </tr>
        </ng-container>

      </ng-container>

    </table>
  </div>

</div>

